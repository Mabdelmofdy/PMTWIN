<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up - PMTwin</title>
    <link rel="stylesheet" href="../css/main.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="navbar-content">
                <a href="../home/" class="navbar-brand">PMTwin</a>
                <button class="navbar-toggle" id="navbarToggle" aria-label="Toggle navigation"><i class="ph ph-list"></i></button>
                <ul class="navbar-nav" id="navbarNav">
                    <li><a href="../home/" class="navbar-link">Home</a></li>
                    <li><a href="../discovery/" class="navbar-link">Discover Projects</a></li>
                    <li><a href="../wizard/" class="navbar-link">PMTwin Wizard</a></li>
                    <li><a href="../knowledge/" class="navbar-link">Knowledge Hub</a></li>
                    <li><a href="../signup/" class="navbar-link active">Sign Up</a></li>
                    <li><a href="../login/" class="navbar-link">Login</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main>
        <div class="container" style="max-width: 700px; padding: 2rem 0;">
            <h1 style="margin-bottom: var(--spacing-4); text-align: center;">Sign Up - PMTwin</h1>
            
            <!-- Progress Indicator -->
            <div class="onboarding-progress" id="onboardingProgress" style="margin-bottom: 2rem;">
                <div class="progress-steps">
                    <div class="progress-step active" data-step="1">
                        <div class="step-number">1</div>
                        <div class="step-label">Account Setup</div>
                    </div>
                    <div class="progress-line"></div>
                    <div class="progress-step" data-step="2">
                        <div class="step-number">2</div>
                        <div class="step-label">Documents & Terms</div>
                    </div>
                    <div class="progress-line"></div>
                    <div class="progress-step" data-step="3">
                        <div class="step-number">3</div>
                        <div class="step-label">Review & Submit</div>
                    </div>
                </div>
            </div>

            <!-- Multi-Step Form -->
            <div class="card">
                <div class="card-body">
                    <form id="signupForm">
                        <!-- Step 1: Account Setup (User Type + Basic Info + Verification) -->
                        <div class="onboarding-step" id="step1" data-step="1">
                            <h2 style="margin-bottom: var(--spacing-4); text-align: center;">Create Your Account</h2>
                            
                            <!-- User Type Selection -->
                            <div style="margin-bottom: 2rem;">
                                <label class="form-label" style="margin-bottom: 0.75rem; display: block;">I want to join as: *</label>
                                <div class="user-type-selection" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                                    <label class="user-type-card" style="cursor: pointer; border: 2px solid var(--color-gray-300); border-radius: var(--radius-md); padding: 1.5rem; text-align: center; transition: all 0.3s;">
                                        <input type="radio" name="userType" value="individual" checked style="display: none;">
                                        <div class="user-type-icon" style="font-size: 2.5rem; margin-bottom: 0.75rem;"><i class="ph ph-user"></i></div>
                                        <div class="user-type-title" style="font-weight: 600; font-size: 1rem; margin-bottom: 0.5rem;">Individual Professional</div>
                                        <div class="user-type-desc" style="color: var(--color-gray-600); font-size: 0.85rem;">For professionals, consultants, and experts</div>
                                    </label>
                                    <label class="user-type-card" style="cursor: pointer; border: 2px solid var(--color-gray-300); border-radius: var(--radius-md); padding: 1.5rem; text-align: center; transition: all 0.3s;">
                                        <input type="radio" name="userType" value="entity" style="display: none;">
                                        <div class="user-type-icon" style="font-size: 2.5rem; margin-bottom: 0.75rem;"><i class="ph ph-buildings"></i></div>
                                        <div class="user-type-title" style="font-weight: 600; font-size: 1rem; margin-bottom: 0.5rem;">Company/Entity</div>
                                        <div class="user-type-desc" style="color: var(--color-gray-600); font-size: 0.85rem;">For companies, contractors, and organizations</div>
                                    </label>
                                </div>
                            </div>
                            <h2 style="margin-bottom: var(--spacing-4); text-align: center;">Basic Information</h2>
                            
                            <!-- Individual Fields -->
                            <div id="individualFields">
                                <div class="form-group">
                                    <label for="signupName" class="form-label">Full Name *</label>
                                    <input type="text" id="signupName" class="form-control" required placeholder="Enter your full name">
                                </div>
                                <div class="form-group">
                                    <label for="signupProfessionalTitle" class="form-label">Professional Title</label>
                                    <input type="text" id="signupProfessionalTitle" class="form-control" placeholder="e.g., Project Manager, Engineer">
                                </div>
                            </div>

                            <!-- Entity Fields -->
                            <div id="entityFields" style="display: none;">
                                <div class="form-group">
                                    <label for="signupCompanyName" class="form-label">Company Name *</label>
                                    <input type="text" id="signupCompanyName" class="form-control" required placeholder="Enter company name">
                                </div>
                                <div class="form-group">
                                    <label for="signupWebsite" class="form-label">Website</label>
                                    <input type="url" id="signupWebsite" class="form-control" placeholder="https://example.com">
                                </div>
                            </div>

                            <!-- Common Fields -->
                            <div class="form-group">
                                <label for="signupEmail" class="form-label">Email *</label>
                                <div style="display: flex; gap: 0.5rem; align-items: start;">
                                    <input type="email" id="signupEmail" class="form-control" required placeholder="your.email@example.com" style="flex: 1;" onblur="signupComponent.onEmailBlur()">
                                    <button type="button" id="sendEmailOTP" class="btn btn-secondary" onclick="signupComponent.sendEmailOTP()" style="white-space: nowrap;">
                                        <i class="ph ph-paper-plane-tilt"></i> Send Code
                                    </button>
                                </div>
                                <div id="emailVerificationStatus" style="margin-top: 0.5rem; display: none;">
                                    <div style="display: flex; gap: 0.5rem; align-items: center; margin-bottom: 0.5rem;">
                                        <input type="text" id="emailOTPInput" class="form-control" placeholder="Enter 6-digit code" maxlength="6" pattern="[0-9]{6}" style="flex: 1;">
                                        <button type="button" class="btn btn-success btn-sm" onclick="signupComponent.verifyEmailOTP()">
                                            <i class="ph ph-check"></i> Verify
                                        </button>
                                    </div>
                                    <div id="emailVerificationMessage" style="font-size: 0.875rem;"></div>
                                    <button type="button" id="resendEmailOTP" class="btn btn-link btn-sm" onclick="signupComponent.sendEmailOTP()" style="display: none; padding: 0; margin-top: 0.25rem;">
                                        Resend Code
                                    </button>
                                </div>
                                <div id="emailVerifiedBadge" style="display: none; margin-top: 0.5rem;">
                                    <span class="badge badge-success">
                                        <i class="ph ph-check-circle"></i> Email Verified
                                    </span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="signupMobile" class="form-label">Mobile Number <span id="mobileRequired" style="color: var(--color-error);">*</span></label>
                                <div style="display: flex; gap: 0.5rem; align-items: start;">
                                    <input type="tel" id="signupMobile" class="form-control" placeholder="+966501234567" style="flex: 1;" onblur="signupComponent.onMobileBlur()">
                                    <button type="button" id="sendMobileOTP" class="btn btn-secondary" onclick="signupComponent.sendMobileOTP()" style="white-space: nowrap;">
                                        <i class="ph ph-paper-plane-tilt"></i> Send Code
                                    </button>
                                </div>
                                <small class="form-help">Required for entities, optional for individuals</small>
                                <div id="mobileVerificationStatus" style="margin-top: 0.5rem; display: none;">
                                    <div style="display: flex; gap: 0.5rem; align-items: center; margin-bottom: 0.5rem;">
                                        <input type="text" id="mobileOTPInput" class="form-control" placeholder="Enter 6-digit code" maxlength="6" pattern="[0-9]{6}" style="flex: 1;">
                                        <button type="button" class="btn btn-success btn-sm" onclick="signupComponent.verifyMobileOTP()">
                                            <i class="ph ph-check"></i> Verify
                                        </button>
                                    </div>
                                    <div id="mobileVerificationMessage" style="font-size: 0.875rem;"></div>
                                    <button type="button" id="resendMobileOTP" class="btn btn-link btn-sm" onclick="signupComponent.sendMobileOTP()" style="display: none; padding: 0; margin-top: 0.25rem;">
                                        Resend Code
                                    </button>
                                </div>
                                <div id="mobileVerifiedBadge" style="display: none; margin-top: 0.5rem;">
                                    <span class="badge badge-success">
                                        <i class="ph ph-check-circle"></i> Mobile Verified
                                    </span>
                                </div>
                            </div>
                            
                            <!-- Location Fields -->
                            <div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border-color);">
                                <h3 style="font-size: 1.1rem; margin-bottom: 1rem;">Location</h3>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                                    <div class="form-group">
                                        <label for="signupCountry" class="form-label">Country *</label>
                                        <select id="signupCountry" class="form-control" required onchange="signupComponent.onCountryChange()">
                                            <option value="">Select Country</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="signupRegion" class="form-label">Region</label>
                                        <select id="signupRegion" class="form-control" onchange="signupComponent.onRegionChange()">
                                            <option value="">Select Region</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="signupCity" class="form-label">City</label>
                                        <select id="signupCity" class="form-control">
                                            <option value="">Select City</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="signupPassword" class="form-label">Password *</label>
                                <input type="password" id="signupPassword" class="form-control" required placeholder="Create a strong password">
                                <small class="form-help">Must be at least 8 characters with uppercase, lowercase, and number</small>
                                <div id="passwordStrength" style="margin-top: 0.5rem; height: 4px; background: var(--color-gray-200); border-radius: 2px; overflow: hidden;">
                                    <div id="passwordStrengthBar" style="height: 100%; width: 0%; transition: all 0.3s;"></div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="signupPasswordConfirm" class="form-label">Confirm Password *</label>
                                <input type="password" id="signupPasswordConfirm" class="form-control" required placeholder="Confirm your password">
                            </div>

                            <div class="step-actions" style="display: flex; justify-content: flex-end; gap: 1rem; margin-top: 2rem;">
                                <button type="button" class="btn btn-primary" onclick="signupComponent.nextStep()">Continue</button>
                            </div>
                        </div>

                        <!-- Step 2: Documents & Terms -->
                        <div class="onboarding-step" id="step2" data-step="2" style="display: none;">
                            <h2 style="margin-bottom: var(--spacing-4); text-align: center;">Upload Documents & Accept Terms</h2>
                            
                            <!-- Individual Documents -->
                            <div id="individualDocuments">
                                <div class="form-group">
                                    <label class="form-label">Professional License/Certification *</label>
                                    <div class="file-upload-area" data-doc-type="professionalLicense" style="border: 2px dashed var(--color-gray-300); border-radius: var(--radius-md); padding: 2rem; text-align: center; cursor: pointer; transition: all 0.3s;">
                                        <input type="file" id="professionalLicense" accept=".pdf,.jpg,.jpeg,.png" style="display: none;">
                                        <div class="file-upload-icon" style="font-size: 2rem; margin-bottom: 0.5rem;"><i class="ph ph-file-text"></i></div>
                                        <div class="file-upload-text">Click to upload or drag and drop</div>
                                        <div class="file-upload-hint" style="color: var(--color-gray-600); font-size: 0.9rem; margin-top: 0.5rem;">PDF, JPG, PNG (Max 5MB)</div>
                                    </div>
                                    <div class="file-preview" id="professionalLicensePreview" style="margin-top: 1rem; display: none;"></div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">CV/Resume *</label>
                                    <div class="file-upload-area" data-doc-type="resume" style="border: 2px dashed var(--color-gray-300); border-radius: var(--radius-md); padding: 2rem; text-align: center; cursor: pointer; transition: all 0.3s;">
                                        <input type="file" id="resume" accept=".pdf,.doc,.docx" style="display: none;">
                                        <div class="file-upload-icon" style="font-size: 2rem; margin-bottom: 0.5rem;"><i class="ph ph-file-text"></i></div>
                                        <div class="file-upload-text">Click to upload or drag and drop</div>
                                        <div class="file-upload-hint" style="color: var(--color-gray-600); font-size: 0.9rem; margin-top: 0.5rem;">PDF, DOC, DOCX (Max 5MB)</div>
                                    </div>
                                    <div class="file-preview" id="resumePreview" style="margin-top: 1rem; display: none;"></div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Portfolio Link (Optional)</label>
                                    <input type="url" id="portfolioLink" class="form-control" placeholder="https://your-portfolio.com">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Additional Certifications (Optional)</label>
                                    <div class="file-upload-area" data-doc-type="additionalCerts" style="border: 2px dashed var(--color-gray-300); border-radius: var(--radius-md); padding: 2rem; text-align: center; cursor: pointer; transition: all 0.3s;">
                                        <input type="file" id="additionalCerts" accept=".pdf,.jpg,.jpeg,.png" multiple style="display: none;">
                                        <div class="file-upload-icon" style="font-size: 2rem; margin-bottom: 0.5rem;"><i class="ph ph-books"></i></div>
                                        <div class="file-upload-text">Click to upload multiple files</div>
                                        <div class="file-upload-hint" style="color: var(--color-gray-600); font-size: 0.9rem; margin-top: 0.5rem;">PDF, JPG, PNG (Max 5MB each)</div>
                                    </div>
                                    <div class="file-preview" id="additionalCertsPreview" style="margin-top: 1rem; display: none;"></div>
                                </div>
                            </div>

                            <!-- Entity Documents -->
                            <div id="entityDocuments" style="display: none;">
                                <div class="form-group">
                                    <label class="form-label">Commercial Registration (CR) *</label>
                                    <div class="file-upload-area" data-doc-type="cr" style="border: 2px dashed var(--color-gray-300); border-radius: var(--radius-md); padding: 2rem; text-align: center; cursor: pointer; transition: all 0.3s;">
                                        <input type="file" id="cr" accept=".pdf,.jpg,.jpeg,.png" style="display: none;">
                                        <div class="file-upload-icon" style="font-size: 2rem; margin-bottom: 0.5rem;"><i class="ph ph-file-text"></i></div>
                                        <div class="file-upload-text">Click to upload or drag and drop</div>
                                        <div class="file-upload-hint" style="color: var(--color-gray-600); font-size: 0.9rem; margin-top: 0.5rem;">PDF, JPG, PNG (Max 5MB)</div>
                                    </div>
                                    <div class="file-preview" id="crPreview" style="margin-top: 1rem; display: none;"></div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">VAT Certificate *</label>
                                    <div class="file-upload-area" data-doc-type="vat" style="border: 2px dashed var(--color-gray-300); border-radius: var(--radius-md); padding: 2rem; text-align: center; cursor: pointer; transition: all 0.3s;">
                                        <input type="file" id="vat" accept=".pdf,.jpg,.jpeg,.png" style="display: none;">
                                        <div class="file-upload-icon" style="font-size: 2rem; margin-bottom: 0.5rem;"><i class="ph ph-file-text"></i></div>
                                        <div class="file-upload-text">Click to upload or drag and drop</div>
                                        <div class="file-upload-hint" style="color: var(--color-gray-600); font-size: 0.9rem; margin-top: 0.5rem;">PDF, JPG, PNG (Max 5MB)</div>
                                    </div>
                                    <div class="file-preview" id="vatPreview" style="margin-top: 1rem; display: none;"></div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Company Profile Document *</label>
                                    <div class="file-upload-area" data-doc-type="companyProfile" style="border: 2px dashed var(--color-gray-300); border-radius: var(--radius-md); padding: 2rem; text-align: center; cursor: pointer; transition: all 0.3s;">
                                        <input type="file" id="companyProfile" accept=".pdf,.doc,.docx" style="display: none;">
                                        <div class="file-upload-icon" style="font-size: 2rem; margin-bottom: 0.5rem;"><i class="ph ph-file-text"></i></div>
                                        <div class="file-upload-text">Click to upload or drag and drop</div>
                                        <div class="file-upload-hint" style="color: var(--color-gray-600); font-size: 0.9rem; margin-top: 0.5rem;">PDF, DOC, DOCX (Max 5MB)</div>
                                    </div>
                                    <div class="file-preview" id="companyProfilePreview" style="margin-top: 1rem; display: none;"></div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Additional Licenses (Optional)</label>
                                    <div class="file-upload-area" data-doc-type="additionalLicenses" style="border: 2px dashed var(--color-gray-300); border-radius: var(--radius-md); padding: 2rem; text-align: center; cursor: pointer; transition: all 0.3s;">
                                        <input type="file" id="additionalLicenses" accept=".pdf,.jpg,.jpeg,.png" multiple style="display: none;">
                                        <div class="file-upload-icon" style="font-size: 2rem; margin-bottom: 0.5rem;"><i class="ph ph-books"></i></div>
                                        <div class="file-upload-text">Click to upload multiple files</div>
                                        <div class="file-upload-hint" style="color: var(--color-gray-600); font-size: 0.9rem; margin-top: 0.5rem;">PDF, JPG, PNG (Max 5MB each)</div>
                                    </div>
                                    <div class="file-preview" id="additionalLicensesPreview" style="margin-top: 1rem; display: none;"></div>
                                </div>
                            </div>

                            <!-- Terms & Conditions -->
                            <div style="margin-top: 2rem; padding-top: 2rem; border-top: 1px solid var(--border-color);">
                                <h3 style="margin-bottom: 1rem; font-size: 1.1rem;">Terms & Conditions</h3>
                                <div class="terms-container" style="max-height: 300px; overflow-y: auto; border: 1px solid var(--color-gray-300); border-radius: var(--radius-md); padding: 1.5rem; margin-bottom: 1.5rem; background: var(--bg-secondary);">
                                    <h4 style="margin-bottom: 0.75rem; font-size: 1rem;">PMTwin Terms of Service</h4>
                                    <p style="margin-bottom: 0.75rem; line-height: 1.6; font-size: 0.9rem;">
                                        By signing up for PMTwin, you agree to the following terms and conditions:
                                    </p>
                                    <ul style="line-height: 1.8; padding-left: 1.5rem; font-size: 0.9rem;">
                                        <li>You are responsible for maintaining the confidentiality of your account</li>
                                        <li>You agree to provide accurate and complete information</li>
                                        <li>You understand that your profile will be reviewed by platform administrators</li>
                                        <li>You agree to comply with all applicable laws and regulations</li>
                                        <li>You understand that PMTwin reserves the right to verify your credentials</li>
                                        <li>You agree to use the platform in accordance with our community guidelines</li>
                                    </ul>
                                    <p style="margin-top: 0.75rem; line-height: 1.6; font-size: 0.9rem;">
                                        For the complete terms of service, please visit our <a href="#" target="_blank">Terms & Conditions</a> page.
                                    </p>
                                </div>

                                <div class="form-group">
                                    <label style="display: flex; align-items: flex-start; cursor: pointer; gap: 0.5rem;">
                                        <input type="checkbox" id="acceptTerms" required style="margin-top: 0.25rem;">
                                        <span>I have read and agree to the Terms & Conditions and Privacy Policy *</span>
                                    </label>
                                </div>
                            </div>

                            <div class="step-actions" style="display: flex; justify-content: space-between; gap: 1rem; margin-top: 2rem;">
                                <button type="button" class="btn btn-secondary" onclick="signupComponent.prevStep()">Back</button>
                                <button type="button" class="btn btn-primary" onclick="signupComponent.nextStep()">Continue</button>
                            </div>
                        </div>

                        <!-- Step 3: Review & Submit -->
                        <div class="onboarding-step" id="step3" data-step="3" style="display: none;">
                            <h2 style="margin-bottom: var(--spacing-4); text-align: center;">Review & Submit</h2>
                            <p style="text-align: center; color: var(--color-gray-600); margin-bottom: 2rem;">
                                Please review your information before submitting your registration.
                            </p>
                            
                            <div class="card" style="margin-bottom: 2rem;">
                                <div class="card-body">
                                    <h3 style="margin-bottom: 1rem;">Verification Status</h3>
                                    <div id="verificationStatusDisplay" style="display: flex; gap: 1rem; margin-bottom: 1rem; flex-wrap: wrap;">
                                        <!-- Status will be populated by JavaScript -->
                                    </div>
                                    <div id="verificationWarning" class="alert alert-warning" style="display: none;">
                                        <i class="ph ph-warning"></i> 
                                        Please complete email and phone verification in Step 1 before proceeding.
                                    </div>
                                </div>
                            </div>

                            <!-- Error/Success Messages -->
                            <div id="signupMessage" style="display: none; margin-top: 1rem;"></div>

                            <div class="step-actions" style="display: flex; justify-content: space-between; gap: 1rem; margin-top: 2rem;">
                                <button type="button" class="btn btn-secondary" onclick="signupComponent.prevStep()">Back</button>
                                <button type="submit" class="btn btn-primary btn-lg">Submit Registration</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <p style="text-align: center; margin-top: var(--spacing-4);">
                Already have an account? <a href="../login/">Login here</a>
            </p>
        </div>
    </main>

    <!-- Configuration (must load first) -->
    <script src="../js/config.js"></script>
    
    <!-- API Layer (for future Java backend integration) -->
    <script src="../js/api/api-client.js"></script>
    <script src="../js/api/api-service.js"></script>
    
    <!-- Location Service -->
    <script src="../services/location/location-service.js"></script>
    
    <!-- Core Scripts -->
    <script src="../js/data.js"></script>
    <script src="../js/auth.js"></script>
    <script src="../js/demo-credentials.js"></script>
    <script src="../services/services-loader.js"></script>
    
    <!-- Component Scripts -->
    <script src="../features/auth/signup.js"></script>
    
    <!-- Initialize Component -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            if (window.auth && window.auth.signup) {
                window.auth.signup.init();
            }
        });
    </script>
</body>
</html>

