<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collaboration Opportunities - PMTwin</title>
    <link rel="stylesheet" href="../../../assets/css/main.css">
    <style>
        .opportunities-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }
        .opportunity-card {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1.5rem;
            transition: all 0.2s;
        }
        .opportunity-card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }
        .status-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.875rem;
            font-weight: 500;
        }
        .status-active { background: #d4edda; color: #155724; }
        .status-draft { background: #fff3cd; color: #856404; }
        .status-closed { background: #f8d7da; color: #721c24; }
        .status-pending { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <!-- Main Content - Sidebar and Navbar are automatically added by layout system -->
    <main>
        <div class="container" style="padding: 2rem 0;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <div>
                    <h1 style="margin-bottom: 0.5rem;">Collaboration Opportunities</h1>
                    <p style="color: var(--text-secondary); margin: 0;">Browse and apply to available collaboration opportunities</p>
                </div>
                <div style="display: flex; gap: 0.5rem;">
                    <button onclick="collaborationComponent.reloadTestData()" class="btn btn-secondary">
                        <i class="ph ph-arrow-clockwise"></i> Reload Test Data
                    </button>
                    <button onclick="collaborationComponent.showCreateForm()" class="btn btn-primary">
                        <i class="ph ph-plus"></i> Create Opportunity
                    </button>
                </div>
            </div>

            <!-- Filter Section -->
            <div class="card enhanced-card" style="margin-bottom: 2rem;">
                <div class="card-body">
                    <h3 style="margin-bottom: 1rem;">Filter Opportunities</h3>
                    <form id="opportunityFiltersForm" onsubmit="return collaborationComponent.applyFilters(event)" class="simplified-form">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                            <div class="simplified-form-group">
                                <label for="modelTypeFilter" class="simplified-form-label">Model Type</label>
                                <select id="modelTypeFilter" class="simplified-form-input">
                                    <option value="">All Types</option>
                                    <option value="1.1">Task-Based Engagement</option>
                                    <option value="1.2">Consortium</option>
                                    <option value="1.3">Project-Specific JV</option>
                                    <option value="1.4">Special Purpose Vehicle</option>
                                    <option value="2.1">Strategic Joint Venture</option>
                                    <option value="2.2">Strategic Alliance</option>
                                    <option value="2.3">Mentorship Program</option>
                                    <option value="3.1">Bulk Purchasing</option>
                                    <option value="3.2">Co-Ownership Pooling</option>
                                    <option value="3.3">Resource Exchange</option>
                                    <option value="4.1">Professional Hiring</option>
                                    <option value="4.2">Consultant Hiring</option>
                                    <option value="5.1">Call for Competition</option>
                                </select>
                            </div>
                            <div class="simplified-form-group">
                                <label for="opportunityStatusFilter" class="simplified-form-label">Status</label>
                                <select id="opportunityStatusFilter" class="simplified-form-input">
                                    <option value="">All Statuses</option>
                                    <option value="active">Active</option>
                                    <option value="draft">Draft</option>
                                    <option value="pending">Pending</option>
                                    <option value="closed">Closed</option>
                                </select>
                            </div>
                            <div class="simplified-form-group">
                                <label for="categoryFilter" class="simplified-form-label">Category</label>
                                <select id="categoryFilter" class="simplified-form-input">
                                    <option value="">All Categories</option>
                                    <option value="Project-Based Collaboration">Project-Based</option>
                                    <option value="Strategic Partnerships">Strategic Partnerships</option>
                                    <option value="Resource Pooling & Sharing">Resource Pooling</option>
                                    <option value="Hiring a Resource">Hiring Resources</option>
                                    <option value="Call for Competition">Competition</option>
                                </select>
                            </div>
                            <div class="simplified-form-group">
                                <label for="relationshipTypeFilter" class="simplified-form-label">Relationship Type</label>
                                <select id="relationshipTypeFilter" class="simplified-form-input">
                                    <option value="">All Types</option>
                                    <option value="B2B">Business to Business</option>
                                    <option value="B2P">Business to Person</option>
                                    <option value="P2B">Person to Business</option>
                                    <option value="P2P">Person to Person</option>
                                </select>
                            </div>
                        </div>
                        <div class="quick-actions" style="margin-top: 1rem;">
                            <button type="submit" class="btn btn-primary">
                                <i class="ph ph-funnel"></i> Apply Filters
                            </button>
                            <button type="button" onclick="collaborationComponent.clearFilters()" class="btn btn-secondary">
                                <i class="ph ph-x"></i> Clear Filters
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Opportunities List -->
            <div id="opportunitiesList">
                <div class="loading">
                    <div class="spinner"></div>
                    <p>Loading opportunities...</p>
                </div>
            </div>
        </div>
    </main>

    <!-- Configuration (must load first) -->
    <script src="../../../src/config/config.js"></script>
    
    <!-- API Layer -->
    <script src="../../../src/core/api/api-client.js"></script>
    <script src="../../../src/core/api/api-service.js"></script>
    
    <!-- Core Scripts -->
    <script src="../../../src/core/data/golden-seed-data.js"></script>
    <script src="../../../src/core/data/data.js"></script>
    <script src="../../../src/core/auth/auth.js"></script>
    <script src="../../../src/core/auth/auth-check.js"></script>
    <script src="../../../src/utils/demo-credentials.js"></script>
    <script src="../../../src/services/services-loader.js"></script>
    <script src="../../../data/data-loader.js"></script>
    
    <!-- Layout System -->
    <script src="../../../src/core/layout/layout.js"></script>
    <script src="../../../src/core/layout/navigation.js"></script>
    <script src="../../../src/core/init/app-init.js"></script>
    
    <!-- Collaboration Scripts -->
    <script src="../../../src/services/collaboration/collaboration-service.js"></script>
    <script src="../../../src/business-logic/models/collaboration-models.js"></script>
    <script src="../../../features/collaboration/collaboration-opportunities.js"></script>
    
    <script>
        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', async function() {
            try {
                // Check authentication first
                const isAuth = await AuthCheck.checkAuth({ requireAuth: true });
                if (!isAuth) {
                    window.location.href = '../../login/';
                    return;
                }
                
                // Wait for layout system to initialize
                if (typeof Layout !== 'undefined') {
                    Layout.init();
                }
                
                // Initialize collaboration opportunities component
                if (typeof collaborationComponent !== 'undefined') {
                    collaborationComponent.init();
                } else {
                    console.error('Collaboration opportunities component not loaded');
                }
            } catch (error) {
                console.error('Error initializing page:', error);
            }
        });
    </script>
</body>
</html>
