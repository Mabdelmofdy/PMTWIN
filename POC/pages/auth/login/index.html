<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - PMTwin</title>
    <script>
        // Set base path dynamically based on current location
        // This fixes path resolution when accessed via Vercel rewrites (/auth/login/ -> /POC/pages/auth/login/index.html)
        (function() {
            const currentPath = window.location.pathname;
            let basePath;
            
            // If accessed via /auth/login/ or /login/, use the user-facing URL path
            // Vercel rewrites handle the /POC/ prefix transparently, so we should use the user-facing path
            if (currentPath.match(/^\/(auth\/)?login\/?$/)) {
                basePath = currentPath.endsWith('/') ? currentPath : currentPath + '/';
            } else if (currentPath.includes('/pages/auth/login')) {
                // Already in correct path structure - use current path as base
                basePath = currentPath.endsWith('/') ? currentPath : currentPath + '/';
            } else {
                // Default fallback - use current path
                basePath = currentPath.endsWith('/') ? currentPath : currentPath + '/';
            }
            
            const base = document.createElement('base');
            base.href = basePath;
            document.head.insertBefore(base, document.head.firstChild);
        })();
    </script>
    <link rel="stylesheet" href="/POC/assets/css/main.css">
</head>
<body class="login-page">
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="navbar-content">
                <a href="../../home/" class="navbar-brand">PMTwin</a>
                <button class="navbar-toggle" id="navbarToggle" aria-label="Toggle navigation"><i class="ph ph-list"></i></button>
                <ul class="navbar-nav" id="navbarNav">
                    <li><a href="../../home/" class="navbar-link">Home</a></li>
                    <li><a href="../../discovery/" class="navbar-link">Discover Projects</a></li>
                    <li><a href="../../wizard/" class="navbar-link">PMTwin Wizard</a></li>
                    <li><a href="../../knowledge/" class="navbar-link">Knowledge Hub</a></li>
                    <li><a href="../../service-providers/" class="navbar-link">Service Providers Directory</a></li>
                    <li><a href="../signup/" class="navbar-link">Sign Up</a></li>
                    <li><a href="./" class="navbar-link active">Login</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main>
        <div style="display: flex; align-items: center; justify-content: center; min-height: calc(100vh - 80px); width: 100%;">
            <div style="width: 100%; max-width: 450px; padding: var(--spacing-4);">
                <h1 style="margin-bottom: var(--spacing-6); text-align: center;">
                    Login
                    <button 
                        class="demo-info-button" 
                        id="demoCredentialsBtn"
                        type="button"
                        title="View demo user credentials"
                        aria-label="View demo user credentials"
                    >!</button>
                </h1>
                <div class="card">
                    <div class="card-body">
                        <form id="loginForm">
                            <div class="form-group">
                                <label for="loginEmail" class="form-label">Email</label>
                                <input type="email" id="loginEmail" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="loginPassword" class="form-label">Password</label>
                                <input type="password" id="loginPassword" class="form-control" required>
                            </div>
                            <div id="loginError" class="alert alert-error" style="display: none;"></div>
                            <button type="submit" class="btn btn-primary btn-block">Login</button>
                        </form>
                        <p style="text-align: center; margin-top: var(--spacing-4);">
                            Don't have an account? <a href="../signup/">Sign up here</a>
                        </p>
                        <p style="text-align: center; margin-top: var(--spacing-2);">
                            <a href="../../home/">Back to Home</a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer id="publicFooter" style="background: var(--bg-dark); color: var(--text-inverse); margin-top: var(--spacing-16);">
        <!-- Footer content will be loaded dynamically -->
    </footer>

    <!-- Configuration (must load first) -->
    <script src="/POC/src/config/config.js"></script>
    
    <!-- API Layer (for future Java backend integration) -->
    <script src="/POC/src/core/api/api-client.js"></script>
    <script src="/POC/src/core/api/api-service.js"></script>
    
    <!-- Core Scripts -->
    <script src="/POC/src/core/data/golden-seed-data.js"></script>
    <script src="/POC/src/core/data/data.js"></script>
    <script src="/POC/src/core/auth/user-manager.js"></script>
    <script src="/POC/src/core/auth/auth.js"></script>
    <script src="/POC/src/core/auth/auth-check.js"></script>
    <script src="/POC/src/utils/demo-credentials.js"></script>
    <script src="/POC/src/utils/check-user-roles.js"></script>
    <script src="/POC/src/services/services-loader.js"></script>
    <script src="/POC/data/data-loader.js"></script>
    
    <!-- Footer Component -->
    <script src="/POC/src/components/footer.js"></script>
    
    <!-- Component Scripts -->
    <script src="/POC/features/auth/login.js"></script>
    
    <!-- Initialize Component -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Check for redirect after login
            const redirect = AuthCheck ? AuthCheck.getLoginRedirect() : null;
            
            if (window.auth && window.auth.login) {
                window.auth.login.init({ redirect: redirect });
            }
        });
    </script>
</body>
</html>

